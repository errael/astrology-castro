#!/usr/bin/bash

CMD=${0##*/}
DIR=${0%/*}

. $DIR/COMMON

exit_msg() {
    echo "target: $CASTRO_TABLES/AstrologFunctions.java" >&2
}

extract() {
    #{funFalse, "False", 0, I_},
    grep '^{fun' $SRC_FUNCTIONS \
        | sed -E 's/\{fun\w+,\s+(".*"),\s+([0-9]),\s+(\w+).*$/    f.add(\1, \2, "\3");/'

    #   | sed -E 's/\{fun\w+,\s+(".*"),\s+([0-9]).*$/    funcs.put(\1, \2);/'
    #   | grep -E -v 'False|True|Add|Sub|Mul|Div|Mod|Neg|
}

cat <<"CODE"
// This file is generated by a script: scipts/extract_functions
// from astrolog's express.cpp which is copyrighted by:
// Walter D. Pullen (Astara@msn.com, http://www.astrolog.org/astrolog.htm)

package com.raelity.astrolog.castro.tables;

class AstrologFunctions
{
private Functions f;
AstrologFunctions(Functions f)
{
    this.f = f;
}

void createEntries()
{
CODE

extract

cat <<"CODE"
}

}
CODE

exit_msg

